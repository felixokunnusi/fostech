{% extends "base.html" %}
{% block content %}
<div class="container mt-4">

  <h2 class="mb-3">Referral Dashboard</h2>

  <div class="alert alert-info">
    Share your referral link:
    <strong>{{ request.host_url }}register?ref={{ referral_code }}</strong>
  </div>

  <div class="row mb-4">
    <div class="col-md-4">
      <div class="card text-center shadow-sm">
        <div class="card-body">
          <h5>Total Referrals</h5>
          <h2>{{ total_referrals }}</h2>
        </div>
      </div>
    </div>

    <div class="col-md-4">
      <div class="card text-center shadow-sm">
        <div class="card-body">
          <h5>Total Earnings</h5>
          <h2>₦{{ "%.2f"|format(total_earnings) }}</h2>
        </div>
      </div>
    </div>

    <div class="col-md-4">
      <div class="card text-center shadow-sm">
        <div class="card-body">
          <h5>Wallet Balance</h5>
          <h2>₦{{ "%.2f"|format(wallet_balance) }}</h2>
        </div>
      </div>
    </div>
  </div>

  <h4>Recent Referral Earnings</h4>
  <table class="table table-striped">
    <thead>
      <tr>
        <th>Referred User</th>
        <th>Amount</th>
        <th>Date</th>
      </tr>
    </thead>
    <tbody>
      {% for e in recent_earnings %}
      <tr>
        <td>{{ e.referred_user.email }}</td>
        <td>₦{{ "%.2f"|format(e.amount) }}</td>
        <td>{{ e.created_at.strftime('%Y-%m-%d') }}</td>
      </tr>
      {% else %}
      <tr>
        <td colspan="3" class="text-center">No referrals yet</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

</div>
{% endblock %}
